<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="nihexporter">
<title>`nihexporter`: an R data package for NIH funding data • nihexporter</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.6/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.6/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="`nihexporter`: an R data package for NIH funding data">
<meta property="og:description" content="nihexporter">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="rnabioco.github.io" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-inverse navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nihexporter</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/nihexporter.html">Intro</a>
    <a class="dropdown-item" href="../articles/nihexporter-manuscript.html">bioRxiv pre-print</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="http://github.com/jayhesselberth/nihexporter/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>`nihexporter`: an R data package for NIH funding data</h1>
                        <h4 data-toc-skip class="author">Jay
Hesselberth</h4>
            
      
      <small class="dont-index">Source: <a href="http://github.com/jayhesselberth/nihexporter/blob/HEAD/vignettes/nihexporter.Rmd" class="external-link"><code>vignettes/nihexporter.Rmd</code></a></small>
      <div class="d-none name"><code>nihexporter.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="abstract">Abstract<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h2>
<p>The National Institutes of Health (NIH) is the major source of
federal funding for biomedical research in the United States. Analysis
of past and current NIH funding can illustrate funding trends and
identify productive research topics, but these analyses are conducted
<em>ad hoc</em> by the institutes themselves and only provide a small
glimpse of the available data. The NIH provides free access to funding
data via NIH EXPORTER, but no tools have been developed to enable
analysis of this data.</p>
<p>We developed the <code>nihexporter</code> R package, which provides
access to <a href="http://exporter.nih.gov/" class="external-link">NIH EXPORTER</a> data. We
used the package to develop several analysis vignettes that show funding
trends across NIH institutes over 15 years and highlight differences in
how institutes change their funding profiles. Investigators and
institutions can use the package to perform self-studies of their own
NIH funding.</p>
<p>The <code>nihexporter</code> R package can be installed via <a href="https://github.com/jayhesselberth/nihexporter" class="external-link">github</a>.</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The National Institutes of Health (NIH) is the major source federal
funds for biomedical research in the United States. The NIH budget is
approved by Congress each year, and in fiscal year 2014, the total NIH
budget was 30.3 billion dollars (REF). The NIH is divided into 25
institutes, each with its own focus and mission. For example, National
Cancer Institue (NCI) focuses on malignant diseases; the National
Institute for Allergy and Immune Disease focuses on the immune system
and transmissible diseasei; and the National Institute for General
Medical Sciences focuses on basic research without a specific disease
focus. Each institute negotiates with the NIH director (currently
Francis Collins, MD, PhD) for its yearly budget, with budget institutes
ranging from millions to several billion dollars.</p>
<p>The NIH provides funds through competitive grants written by internal
and external investigators, and the funds associated with these grants
can be divided into ‘direct’ and ‘indirect’ costs. <strong>Direct
costs</strong> are funds that are given to an investigator (or group of
investigators) to conduct their proposed research. These funds buy
supplies for the experiments and pay the salaries of people to do the
work.</p>
<p>By contrast, <strong>indirect costs</strong> are funds that are paid
to institutions associated with investigators, and are used to “keep the
lights on”: they pay for infrastructure costs. However, the “indirect
cost recovery” (ICR) rate of each institution, the fraction of each
award the institute receives, is congressionally mandated, and there is
a wide range in ICR rates. Some of the highest ICR rates are close to
100%, meaning that for every dollar an investigator receives, the
institutions receive an equal amount.</p>
<p>NIH funding is an investment strategy: the institutes invest money in
specific research areas, hoping for future returns in the form of
publications, patents and skilled trainees. As with any investment
strategy, a periodic review can help rebalance the portfolio in order to
maximize returns. Analysis of NIH funding data has been performed
internally by the NIH, or by contracted third-parties. Several of these
analyses have highlighted funding trends and suggested metrics to gauge
the ‘return’ on the NIH ‘investment’. For example, “productivity” can be
examined as a function of the number of publications produced by grants
per dollar of “direct costs”.</p>
</div>
<div class="section level2">
<h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>
<p>We downloaded NIH funding data from the NIH EXPORTER website in
comma-separated value (CSV) format and parsed these data into R data
files that each contain specific information:</p>
<ul>
<li>
<code>projects</code> has information about projects in each fiscal
year, keyed by <code>project.num</code>
</li>
<li>
<code>org_info</code> has information about project
organizations</li>
<li>
<code>project_orgs</code> links applications to organizations</li>
<li>
<code>project_pis</code> links PI information to a project</li>
<li>
<code>publinks</code> table links PubMed IDs to
<code>project.num</code>
</li>
<li>
<code>publications</code> links project IDs to PubMed IDs</li>
<li>
<code>patents</code> links patent IDs to project IDs</li>
</ul>
<p>See the documentation in the R package for more information about
each table.</p>
<p>The package also has several precomputed variables and tables that
enable quick and easy exploratory analysis:</p>
<ul>
<li>
<code>nih.institutes</code>: Two-letter format for 27 NIH
institutes</li>
<li>
<code>project_io</code>: This table contains pre-computed values for
overall project cost (<code>project.cost</code>), as well as the number
of publications (<code>n.pubs</code>) and patents
(<code>n.patents</code>) associated with each project.</li>
</ul>
<p>NIH EXPORTER provides access to the total costs of each grant in each
fiscal year, comprising both direct and indirect costs.</p>
<p>We developed several analyses using the <code>dplyr</code>,
<code>ggplot2</code> and <code>knitr</code> packages in the RStudio
environment.</p>
</div>
<div class="section level2">
<h2 id="results-and-discussion">Results and Discussion<a class="anchor" aria-label="anchor" href="#results-and-discussion"></a>
</h2>
<div class="section level3">
<h3 id="project-costs">Project costs<a class="anchor" aria-label="anchor" href="#project-costs"></a>
</h3>
<p>Let’s look at the costs of grants over time for a few institutes:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/jayhesselberth/nihexporter" class="external-link">nihexporter</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">select_inst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'GM'</span>, <span class="st">'AI'</span>, <span class="st">'CA'</span><span class="op">)</span></span>
<span><span class="va">cost.over.time</span> <span class="op">&lt;-</span> <span class="va">projects</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">institute</span>, <span class="va">fy.cost</span>, <span class="va">fiscal.year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">institute</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">select_inst</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">fiscal.year</span>, <span class="va">institute</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>yearly.cost <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">fy.cost</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cost.over.time</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">fiscal.year</span><span class="op">)</span>, </span>
<span>             y <span class="op">=</span> <span class="va">yearly.cost</span> <span class="op">/</span> <span class="fl">1e9</span>,</span>
<span>             group <span class="op">=</span> <span class="va">institute</span>, color <span class="op">=</span> <span class="va">institute</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'bottom'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Fiscal year'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">'Project costs (dollars in billions)'</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="nihexporter_files/figure-html/inst_cost_over_time-1.png" alt="Project spending at NIGMS, NCI and NIAID" width="672"><p class="caption">
Project spending at NIGMS, NCI and NIAID
</p>
</div>
</div>
<div class="section level3">
<h3 id="funding-distributions">Funding distributions<a class="anchor" aria-label="anchor" href="#funding-distributions"></a>
</h3>
<div class="section level4">
<h4 id="by-institution">By Institution<a class="anchor" aria-label="anchor" href="#by-institution"></a>
</h4>
<p>Let’s look <em>where</em> the money is going. This example
illustrates linking of the <code>project</code>, <code>org_info</code>
and <code>project_orgs</code> tables.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">institution_funding</span> <span class="op">&lt;-</span> <span class="va">projects</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">activity</span> <span class="op">==</span> <span class="st">'R01'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">project_orgs</span>, by <span class="op">=</span> <span class="st">'application.id'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">org.duns</span>, <span class="va">fiscal.year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total.dollars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">fy.cost</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">org_info</span>, by <span class="op">=</span> <span class="st">'org.duns'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">total.dollars</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">institution_funding</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">fiscal.year</span>, <span class="va">org.name</span>, <span class="va">org.duns</span>, <span class="va">total.dollars</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>total.award.millions <span class="op">=</span> <span class="va">total.dollars</span> <span class="op">/</span> <span class="fl">1e6</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">total.dollars</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>caption<span class="op">=</span><span class="st">'R01 grant dollars awarded to specific institutions'</span>,</span>
<span>               col.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Fiscal year'</span>, <span class="st">'Org.'</span>,</span>
<span>                           <span class="st">'DUNS'</span>, <span class="st">'Dollars (millions)'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>R01 grant dollars awarded to specific institutions</caption>
<thead><tr class="header">
<th align="right">Fiscal year</th>
<th align="left">Org.</th>
<th align="right">DUNS</th>
<th align="right">Dollars (millions)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2009</td>
<td align="left">JOHNS HOPKINS UNIVERSITY</td>
<td align="right">1910777</td>
<td align="right">297.2806</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="left">JOHNS HOPKINS UNIVERSITY</td>
<td align="right">1910777</td>
<td align="right">292.9498</td>
</tr>
<tr class="odd">
<td align="right">2004</td>
<td align="left">JOHNS HOPKINS UNIVERSITY</td>
<td align="right">1910777</td>
<td align="right">289.2175</td>
</tr>
<tr class="even">
<td align="right">2011</td>
<td align="left">JOHNS HOPKINS UNIVERSITY</td>
<td align="right">1910777</td>
<td align="right">286.3747</td>
</tr>
<tr class="odd">
<td align="right">2005</td>
<td align="left">JOHNS HOPKINS UNIVERSITY</td>
<td align="right">1910777</td>
<td align="right">278.1270</td>
</tr>
<tr class="even">
<td align="right">2012</td>
<td align="left">JOHNS HOPKINS UNIVERSITY</td>
<td align="right">1910777</td>
<td align="right">273.9458</td>
</tr>
<tr class="odd">
<td align="right">2006</td>
<td align="left">JOHNS HOPKINS UNIVERSITY</td>
<td align="right">1910777</td>
<td align="right">270.8518</td>
</tr>
<tr class="even">
<td align="right">2007</td>
<td align="left">JOHNS HOPKINS UNIVERSITY</td>
<td align="right">1910777</td>
<td align="right">268.4021</td>
</tr>
<tr class="odd">
<td align="right">2003</td>
<td align="left">JOHNS HOPKINS UNIVERSITY</td>
<td align="right">1910777</td>
<td align="right">266.1683</td>
</tr>
<tr class="even">
<td align="right">2015</td>
<td align="left">JOHNS HOPKINS UNIVERSITY</td>
<td align="right">1910777</td>
<td align="right">265.8217</td>
</tr>
</tbody>
</table>
<p>We can also identify movers-and-shakers by institution.</p>
</div>
<div class="section level4">
<h4 id="by-pi">By PI<a class="anchor" aria-label="anchor" href="#by-pi"></a>
</h4>
<p>One can also examine how dollars are accrued by specific PIs. It is
not possible to assign dollars directly to a PI, because some grants
have multiple investigators. Rather, these are total costs that a given
PI has been associated with over all grants in NIH EXPORTER. Here we
identify PIs with the largest dollar amounts accrued for R01 grants.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dollars.per.pi</span> <span class="op">&lt;-</span> <span class="va">projects</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">activity</span> <span class="op">==</span> <span class="st">'R01'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">project_io</span>, by <span class="op">=</span> <span class="st">'project.num'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">project_pis</span>, by <span class="op">=</span> <span class="st">'project.num'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">pi.id</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">project.num</span>, <span class="va">pi.id</span>, <span class="va">total.cost</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">pi.id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>pi.dollars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total.cost</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1e6</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">pi.dollars</span><span class="op">)</span><span class="op">)</span>  </span>
<span></span>
<span><span class="va">dollars.per.pi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span>,</span>
<span>               caption <span class="op">=</span> <span class="st">'R01 grant dollars associated with specific PIs'</span>,</span>
<span>               col.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'PI ID'</span>, <span class="st">'Dollars (millions)'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>R01 grant dollars associated with specific PIs</caption>
<thead><tr class="header">
<th align="right">PI ID</th>
<th align="right">Dollars (millions)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1888524</td>
<td align="right">99.854</td>
</tr>
<tr class="even">
<td align="right">1883846</td>
<td align="right">93.276</td>
</tr>
<tr class="odd">
<td align="right">2085656</td>
<td align="right">69.901</td>
</tr>
<tr class="even">
<td align="right">6719627</td>
<td align="right">69.901</td>
</tr>
<tr class="odd">
<td align="right">1858142</td>
<td align="right">58.942</td>
</tr>
<tr class="even">
<td align="right">1866338</td>
<td align="right">52.601</td>
</tr>
<tr class="odd">
<td align="right">1862760</td>
<td align="right">51.599</td>
</tr>
<tr class="even">
<td align="right">1876724</td>
<td align="right">47.021</td>
</tr>
<tr class="odd">
<td align="right">1878095</td>
<td align="right">43.606</td>
</tr>
<tr class="even">
<td align="right">1889062</td>
<td align="right">42.986</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="productivity">Productivity<a class="anchor" aria-label="anchor" href="#productivity"></a>
</h3>
<p>In order to measure the “return” on the money the NIH invests in the
research enterprise, we can measure scholarly output (i.e.,
publications) per dollar invested.</p>
<p>Here we identify th highest performing grants outside of the R01
category. Much has been made of the wasteful spending outside of
investigator-initiated research. Here we identify the cost of
publications for grants other than R01’s that cost more than 1 million
dollars.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">high.perf.not.r01</span> <span class="op">&lt;-</span> <span class="va">projects</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">activity</span> <span class="op">!=</span> <span class="st">'R01'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">project_io</span>, by <span class="op">=</span> <span class="st">'project.num'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">project.num</span>, <span class="va">total.cost</span>, <span class="va">n.pubs</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">total.cost</span> <span class="op">&gt;</span> <span class="fl">1e6</span> <span class="op">&amp;</span> <span class="va">n.pubs</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cost.per.pub <span class="op">=</span> <span class="va">total.cost</span> <span class="op">/</span> <span class="va">n.pubs</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">cost.per.pub</span><span class="op">)</span></span>
<span></span>
<span><span class="va">high.perf.not.r01</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>total.cost <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">total.cost</span> <span class="op">/</span> <span class="fl">1e6</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>         cost.per.pub <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">comma</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cost.per.pub</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>caption<span class="op">=</span><span class="st">'Productivity (publications / dollar) of non-R01 grants'</span>,</span>
<span>               col.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Project ID'</span>, <span class="st">'Project cost (dollars, millions)'</span>,</span>
<span>                           <span class="st">'Number of publications'</span>, <span class="st">'Cost per publications (dollars)'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Productivity (publications / dollar) of non-R01
grants</caption>
<colgroup>
<col width="12%">
<col width="33%">
<col width="23%">
<col width="32%">
</colgroup>
<thead><tr class="header">
<th align="left">Project ID</th>
<th align="right">Project cost (dollars, millions)</th>
<th align="right">Number of publications</th>
<th align="left">Cost per publications (dollars)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">P30CA007175</td>
<td align="right">2.449</td>
<td align="right">721</td>
<td align="left">3,397</td>
</tr>
<tr class="even">
<td align="left">P30DK025295</td>
<td align="right">2.565</td>
<td align="right">691</td>
<td align="left">3,712</td>
</tr>
<tr class="odd">
<td align="left">P30DK025295</td>
<td align="right">2.565</td>
<td align="right">691</td>
<td align="left">3,712</td>
</tr>
<tr class="even">
<td align="left">P30DK025295</td>
<td align="right">2.565</td>
<td align="right">691</td>
<td align="left">3,712</td>
</tr>
<tr class="odd">
<td align="left">P30MH030929</td>
<td align="right">1.710</td>
<td align="right">444</td>
<td align="left">3,851</td>
</tr>
<tr class="even">
<td align="left">P30MH031302</td>
<td align="right">1.046</td>
<td align="right">266</td>
<td align="left">3,931</td>
</tr>
<tr class="odd">
<td align="left">P01CA018221</td>
<td align="right">2.727</td>
<td align="right">692</td>
<td align="left">3,941</td>
</tr>
<tr class="even">
<td align="left">P01CA018221</td>
<td align="right">2.727</td>
<td align="right">692</td>
<td align="left">3,941</td>
</tr>
<tr class="odd">
<td align="left">P41RR001008</td>
<td align="right">1.506</td>
<td align="right">366</td>
<td align="left">4,115</td>
</tr>
<tr class="even">
<td align="left">P41RR001008</td>
<td align="right">1.506</td>
<td align="right">366</td>
<td align="left">4,115</td>
</tr>
</tbody>
</table>
<p>We can also identify the specific publications associated with grants
with the least expensive publications.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">high.perf.not.r01</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">project.num</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">publinks</span>, by <span class="op">=</span> <span class="st">'project.num'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>caption<span class="op">=</span><span class="st">'Publications from the most productive grants'</span>,</span>
<span>               col.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Project ID'</span>, <span class="st">'Pubmed ID'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Publications from the most productive grants</caption>
<thead><tr class="header">
<th align="left">Project ID</th>
<th align="right">Pubmed ID</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">P30CA007175</td>
<td align="right">3934045</td>
</tr>
<tr class="even">
<td align="left">P30CA007175</td>
<td align="right">2983611</td>
</tr>
<tr class="odd">
<td align="left">P30CA007175</td>
<td align="right">2856928</td>
</tr>
<tr class="even">
<td align="left">P30CA007175</td>
<td align="right">3863702</td>
</tr>
<tr class="odd">
<td align="left">P30CA007175</td>
<td align="right">3895298</td>
</tr>
</tbody>
</table>
<p>We can also identify productive PIs with current R01s …</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">productive.pis</span> <span class="op">&lt;-</span> <span class="va">projects</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">activity</span> <span class="op">==</span> <span class="st">'R01'</span> <span class="op">&amp;</span> <span class="va">fiscal.year</span> <span class="op">==</span> <span class="fl">2014</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">project.num</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">project_io</span>, by <span class="op">=</span> <span class="st">'project.num'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">project_pis</span>, by <span class="op">=</span> <span class="st">'project.num'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">pi.id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>total.pi.dollars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total.cost</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            total.pubs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n.pubs</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pub.cost <span class="op">=</span> <span class="va">total.pi.dollars</span> <span class="op">/</span> <span class="va">total.pubs</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># prevent PI Ids from being commafied</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pi.id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">pi.id</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">pub.cost</span><span class="op">)</span></span>
<span></span>
<span><span class="va">productive.pis</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">0</span>,</span>
<span>               format.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>big.mark <span class="op">=</span> <span class="st">','</span><span class="op">)</span>,</span>
<span>               col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'PI ID'</span>,</span>
<span>                             <span class="st">'Cost per publication (dollars)'</span>,</span>
<span>                             <span class="st">'Total publications'</span>,</span>
<span>                             <span class="st">'Total project costs (dollars)'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="9%">
<col width="35%">
<col width="21%">
<col width="34%">
</colgroup>
<thead><tr class="header">
<th align="left">PI ID</th>
<th align="right">Cost per publication (dollars)</th>
<th align="right">Total publications</th>
<th align="right">Total project costs (dollars)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1891786</td>
<td align="right">498,708</td>
<td align="right">105</td>
<td align="right">4,750</td>
</tr>
<tr class="even">
<td align="left">1888041</td>
<td align="right">2,429,682</td>
<td align="right">312</td>
<td align="right">7,787</td>
</tr>
<tr class="odd">
<td align="left">1876101</td>
<td align="right">5,733,230</td>
<td align="right">589</td>
<td align="right">9,734</td>
</tr>
<tr class="even">
<td align="left">1875446</td>
<td align="right">5,517,970</td>
<td align="right">517</td>
<td align="right">10,673</td>
</tr>
<tr class="odd">
<td align="left">1880305</td>
<td align="right">1,047,303</td>
<td align="right">92</td>
<td align="right">11,384</td>
</tr>
<tr class="even">
<td align="left">1891745</td>
<td align="right">1,441,602</td>
<td align="right">124</td>
<td align="right">11,626</td>
</tr>
<tr class="odd">
<td align="left">2232971</td>
<td align="right">1,665,822</td>
<td align="right">133</td>
<td align="right">12,525</td>
</tr>
<tr class="even">
<td align="left">1877469</td>
<td align="right">1,198,769</td>
<td align="right">95</td>
<td align="right">12,619</td>
</tr>
<tr class="odd">
<td align="left">1861696</td>
<td align="right">1,629,417</td>
<td align="right">129</td>
<td align="right">12,631</td>
</tr>
<tr class="even">
<td align="left">1888187</td>
<td align="right">1,629,417</td>
<td align="right">129</td>
<td align="right">12,631</td>
</tr>
</tbody>
</table>
<p>Or we can identify the all-time most produtive PIs, independent of
grant type or time frame …</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">productive.pis.all.time</span> <span class="op">&lt;-</span> <span class="va">projects</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">project.num</span>, <span class="va">activity</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">project_io</span>, by <span class="op">=</span> <span class="st">'project.num'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">project_pis</span>, by <span class="op">=</span> <span class="st">'project.num'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">pi.id</span>, <span class="va">activity</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>total.pi.dollars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">total.cost</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            total.pubs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n.pubs</span><span class="op">)</span>,</span>
<span>            total.patents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">n.patents</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">total.pi.dollars</span> <span class="op">&gt;=</span> <span class="fl">1e6</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pub.cost <span class="op">=</span> <span class="va">total.pi.dollars</span> <span class="op">/</span> <span class="va">total.pubs</span>,</span>
<span>         patent.cost <span class="op">=</span> <span class="va">total.pi.dollars</span> <span class="op">/</span> <span class="va">total.patents</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">pi.id</span>, <span class="va">activity</span>, <span class="va">pub.cost</span>, <span class="va">patent.cost</span>, </span>
<span>         <span class="va">total.pubs</span>, <span class="va">total.patents</span>, <span class="va">total.pi.dollars</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pi.id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">pi.id</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">productive.pis.all.time</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">patent.cost</span>, <span class="op">-</span><span class="va">total.patents</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">pub.cost</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">0</span>,</span>
<span>               format.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>big.mark <span class="op">=</span> <span class="st">','</span><span class="op">)</span>,</span>
<span>               caption <span class="op">=</span> <span class="st">'Most productive PIs all time for publications'</span>,</span>
<span>               col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'PI ID'</span>, <span class="st">'Grant type'</span>,</span>
<span>                             <span class="st">'Cost per publication (dollars)'</span>,</span>
<span>                             <span class="st">'Total publications'</span>,</span>
<span>                             <span class="st">'Total dollars'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Most productive PIs all time for publications</caption>
<colgroup>
<col width="10%">
<col width="13%">
<col width="36%">
<col width="22%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th align="left">PI ID</th>
<th align="left">Grant type</th>
<th align="right">Cost per publication (dollars)</th>
<th align="right">Total publications</th>
<th align="right">Total dollars</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">7846601</td>
<td align="left">K01</td>
<td align="right">1,191</td>
<td align="right">2,080</td>
<td align="right">2,477,445</td>
</tr>
<tr class="even">
<td align="left">1859703</td>
<td align="left">R01</td>
<td align="right">1,606</td>
<td align="right">2,651</td>
<td align="right">4,258,588</td>
</tr>
<tr class="odd">
<td align="left">2412990</td>
<td align="left">R13</td>
<td align="right">1,996</td>
<td align="right">1,840</td>
<td align="right">3,673,380</td>
</tr>
<tr class="even">
<td align="left">1864203</td>
<td align="left">R37</td>
<td align="right">2,900</td>
<td align="right">360</td>
<td align="right">1,044,032</td>
</tr>
<tr class="odd">
<td align="left">1867565</td>
<td align="left">K22</td>
<td align="right">2,912</td>
<td align="right">459</td>
<td align="right">1,336,743</td>
</tr>
<tr class="even">
<td align="left">6195169</td>
<td align="left">K24</td>
<td align="right">2,958</td>
<td align="right">1,912</td>
<td align="right">5,655,968</td>
</tr>
<tr class="odd">
<td align="left">10272731</td>
<td align="left">ZIA</td>
<td align="right">2,966</td>
<td align="right">462</td>
<td align="right">1,370,516</td>
</tr>
<tr class="even">
<td align="left">6224670</td>
<td align="left">Z01</td>
<td align="right">3,026</td>
<td align="right">386</td>
<td align="right">1,168,074</td>
</tr>
<tr class="odd">
<td align="left">8189566</td>
<td align="left">Z01</td>
<td align="right">3,026</td>
<td align="right">386</td>
<td align="right">1,168,074</td>
</tr>
<tr class="even">
<td align="left">9693943</td>
<td align="left">Z01</td>
<td align="right">3,026</td>
<td align="right">386</td>
<td align="right">1,168,074</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">productive.pis.all.time</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">pub.cost</span>, <span class="op">-</span><span class="va">total.pubs</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">patent.cost</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">0</span>,</span>
<span>               format.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>big.mark <span class="op">=</span> <span class="st">','</span><span class="op">)</span>,</span>
<span>               caption <span class="op">=</span> <span class="st">'Most productive PIs all time for patents'</span>,</span>
<span>               col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'PI ID'</span>, <span class="st">'Grant type'</span>,</span>
<span>                             <span class="st">'Cost per patent (dollars)'</span>,</span>
<span>                             <span class="st">'Total patents'</span>,</span>
<span>                             <span class="st">'Total dollars'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Most productive PIs all time for patents</caption>
<colgroup>
<col width="10%">
<col width="15%">
<col width="35%">
<col width="19%">
<col width="19%">
</colgroup>
<thead><tr class="header">
<th align="left">PI ID</th>
<th align="left">Grant type</th>
<th align="right">Cost per patent (dollars)</th>
<th align="right">Total patents</th>
<th align="right">Total dollars</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1892862</td>
<td align="left">R13</td>
<td align="right">30,984</td>
<td align="right">184</td>
<td align="right">5,700,986</td>
</tr>
<tr class="even">
<td align="left">1883257</td>
<td align="left">R01</td>
<td align="right">35,226</td>
<td align="right">183</td>
<td align="right">6,446,436</td>
</tr>
<tr class="odd">
<td align="left">1863886</td>
<td align="left">R01</td>
<td align="right">35,634</td>
<td align="right">125</td>
<td align="right">4,454,270</td>
</tr>
<tr class="even">
<td align="left">1928069</td>
<td align="left">K08</td>
<td align="right">41,130</td>
<td align="right">27</td>
<td align="right">1,110,510</td>
</tr>
<tr class="odd">
<td align="left">7700352</td>
<td align="left">R21</td>
<td align="right">50,081</td>
<td align="right">20</td>
<td align="right">1,001,626</td>
</tr>
<tr class="even">
<td align="left">1884090</td>
<td align="left">K26</td>
<td align="right">54,663</td>
<td align="right">50</td>
<td align="right">2,733,145</td>
</tr>
<tr class="odd">
<td align="left">1888479</td>
<td align="left">K05</td>
<td align="right">55,467</td>
<td align="right">230</td>
<td align="right">12,757,500</td>
</tr>
<tr class="even">
<td align="left">1896779</td>
<td align="left">R01</td>
<td align="right">56,486</td>
<td align="right">26</td>
<td align="right">1,468,630</td>
</tr>
<tr class="odd">
<td align="left">8259763</td>
<td align="left">R01</td>
<td align="right">56,513</td>
<td align="right">32</td>
<td align="right">1,808,418</td>
</tr>
<tr class="even">
<td align="left">1881108</td>
<td align="left">T32</td>
<td align="right">57,916</td>
<td align="right">40</td>
<td align="right">2,316,625</td>
</tr>
</tbody>
</table>
<p>When <a href="http://www.nigms.nih.gov/about/director/pages/berg.aspx" class="external-link">Jeremy
Berg</a> was head of the Institute of General Medical Sciences (NIGMS)
from 2003-2011, he routinely provided analysis of funding trends at
NIGMS in his “Feedback Loop” blog. One of these measured the
productivity per grant dollar by measuring its “scholarly output”
(<em>i.e.</em>, publications) as a function of direct costs. In this <a href="http://loop.nigms.nih.gov/2010/09/measuring-the-scientific-output-and-impact-of-nigms-grants/" class="external-link">plot</a>
there is an increase in productivity per dollar, until an inflection
point at $700K, after which the number of publications <em>drops</em>,
suggesting a negative influence of grant money on scholarly output. This
was interesting and covered <a href="http://www.nature.com/news/2010/101116/full/468356a.html" class="external-link">here</a>.</p>
<p>Here we flesh out this analysis and look at how all institutes
perform by this measure (Berg, and now Lorsch, only analyzed GM). One
caveat is that we only have access to <code>total.cost</code> in NIH
EXPORTER, so the numbers include indirect costs. But, this is real cost
to the tax-payer.</p>
<p>First, we need to calculate the lifetime costs of all R01 grants.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate costs of all grants, over the entire lifetime of the grant</span></span>
<span><span class="va">grant_costs</span> <span class="op">&lt;-</span> <span class="va">projects</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">institute</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">nih.institutes</span> <span class="op">&amp;</span> <span class="va">activity</span> <span class="op">==</span> <span class="st">'R01'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">project_io</span>, by <span class="op">=</span> <span class="st">'project.num'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">institute</span>, <span class="va">project.num</span>, <span class="va">total.cost</span>, <span class="va">n.pubs</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">grant_costs</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 87,216 × 4</span></span></span>
<span><span class="co">#&gt;    institute project.num total.cost n.pubs</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> AA        R01AA000187     <span style="text-decoration: underline;">192</span>057     44</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> AA        R01AA000279    1<span style="text-decoration: underline;">368</span>179      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> AA        R01AA000626    4<span style="text-decoration: underline;">256</span>757     94</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> AA        R01AA002666    2<span style="text-decoration: underline;">635</span>998    160</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> AA        R01AA002686    7<span style="text-decoration: underline;">088</span>071     59</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> AA        R01AA003037     <span style="text-decoration: underline;">710</span>028     12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> AA        R01AA003490    2<span style="text-decoration: underline;">285</span>856     31</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> AA        R01AA003972    2<span style="text-decoration: underline;">695</span>918     51</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> AA        R01AA004610    5<span style="text-decoration: underline;">035</span>947     32</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> AA        R01AA004961     <span style="text-decoration: underline;">477</span>993     68</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 87,206 more rows</span></span></span></code></pre></div>
<p>Next, we need to identify grants in each of the bins that Berg
previously alluded to. <code>dplyr</code> makes this easy with the
<code><a href="https://dplyr.tidyverse.org/reference/ntile.html" class="external-link">ntile()</a></code> function. Berg previously divided grants into ~15
bins, we’ll bin into ~5%.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bin_grant_costs</span> <span class="op">&lt;-</span> <span class="va">grant_costs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">institute</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span>n.tile <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/ntile.html" class="external-link">ntile</a></span><span class="op">(</span><span class="va">total.cost</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">bin_grant_costs</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 87,216 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   n.tile [21]</span></span></span>
<span><span class="co">#&gt;    institute project.num total.cost n.pubs n.tile</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> AA        R01AA000187     <span style="text-decoration: underline;">192</span>057     44      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> AA        R01AA000279    1<span style="text-decoration: underline;">368</span>179      1     10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> AA        R01AA000626    4<span style="text-decoration: underline;">256</span>757     94     19</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> AA        R01AA002666    2<span style="text-decoration: underline;">635</span>998    160     17</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> AA        R01AA002686    7<span style="text-decoration: underline;">088</span>071     59     20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> AA        R01AA003037     <span style="text-decoration: underline;">710</span>028     12      4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> AA        R01AA003490    2<span style="text-decoration: underline;">285</span>856     31     16</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> AA        R01AA003972    2<span style="text-decoration: underline;">695</span>918     51     17</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> AA        R01AA004610    5<span style="text-decoration: underline;">035</span>947     32     20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> AA        R01AA004961     <span style="text-decoration: underline;">477</span>993     68      2</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 87,206 more rows</span></span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Berg's original values ...</span></span>
<span><span class="co"># breaks &lt;- c(175000, 200000, 225000, 250000, 300000, 375000, 400000,</span></span>
<span><span class="co">#           450000, 500000, 600000, 700000, 800000, 900000, 1000000)</span></span>
<span><span class="va">min.lifetime.cost</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">grant_costs</span><span class="op">$</span><span class="va">total.cost</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="op">-</span><span class="fl">4</span><span class="op">)</span> <span class="co"># round to 10,000s</span></span>
<span><span class="va">max.lifetime.cost</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">grant_costs</span><span class="op">$</span><span class="va">total.cost</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="op">-</span><span class="fl">5</span><span class="op">)</span> </span>
<span><span class="co"># step is average size of an award</span></span>
<span><span class="va">step</span> <span class="op">&lt;-</span> <span class="fl">1e6</span></span>
<span></span>
<span><span class="va">breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">min.lifetime.cost</span>, <span class="va">max.lifetime.cost</span>, <span class="va">step</span><span class="op">)</span></span>
<span><span class="va">breaks</span></span>
<span><span class="co">#&gt;  [1] 0.0e+00 1.0e+06 2.0e+06 3.0e+06 4.0e+06 5.0e+06 6.0e+06 7.0e+06</span></span>
<span><span class="co">#&gt;  [9] 8.0e+06 9.0e+06 1.0e+07 1.1e+07 1.2e+07 1.3e+07 1.4e+07 1.5e+07</span></span>
<span><span class="co">#&gt; [17] 1.6e+07 1.7e+07 1.8e+07 1.9e+07 2.0e+07 2.1e+07 2.2e+07 2.3e+07</span></span>
<span><span class="co">#&gt; [25] 2.4e+07 2.5e+07 2.6e+07 2.7e+07 2.8e+07 2.9e+07 3.0e+07 3.1e+07</span></span>
<span><span class="co">#&gt; [33] 3.2e+07 3.3e+07 3.4e+07 3.5e+07 3.6e+07 3.7e+07 3.8e+07 3.9e+07</span></span>
<span><span class="co">#&gt; [41] 4.0e+07 4.1e+07 4.2e+07 4.3e+07 4.4e+07 4.5e+07 4.6e+07 4.7e+07</span></span>
<span><span class="co">#&gt; [49] 4.8e+07 4.9e+07 5.0e+07 5.1e+07 5.2e+07 5.3e+07 5.4e+07 5.5e+07</span></span>
<span><span class="co">#&gt; [57] 5.6e+07 5.7e+07 5.8e+07 5.9e+07 6.0e+07 6.1e+07 6.2e+07 6.3e+07</span></span>
<span><span class="co">#&gt; [65] 6.4e+07 6.5e+07 6.6e+07 6.7e+07 6.8e+07 6.9e+07 7.0e+07 7.1e+07</span></span>
<span><span class="co">#&gt; [73] 7.2e+07 7.3e+07 7.4e+07 7.5e+07 7.6e+07 7.7e+07</span></span>
<span></span>
<span><span class="va">dollar_bin_grant_costs</span> <span class="op">&lt;-</span> <span class="va">grant_costs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">institute</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dollar.tile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/findInterval.html" class="external-link">findInterval</a></span><span class="op">(</span><span class="va">total.cost</span>, vec <span class="op">=</span> <span class="va">breaks</span>, </span>
<span>                                    all.inside <span class="op">=</span> <span class="cn">TRUE</span>, rightmost.closed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dollar_bin_grant_costs</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 87,216 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   institute [24]</span></span></span>
<span><span class="co">#&gt;    institute project.num total.cost n.pubs dollar.tile</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> AA        R01AA000187     <span style="text-decoration: underline;">192</span>057     44           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> AA        R01AA000279    1<span style="text-decoration: underline;">368</span>179      1           2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> AA        R01AA000626    4<span style="text-decoration: underline;">256</span>757     94           5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> AA        R01AA002666    2<span style="text-decoration: underline;">635</span>998    160           3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> AA        R01AA002686    7<span style="text-decoration: underline;">088</span>071     59           8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> AA        R01AA003037     <span style="text-decoration: underline;">710</span>028     12           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> AA        R01AA003490    2<span style="text-decoration: underline;">285</span>856     31           3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> AA        R01AA003972    2<span style="text-decoration: underline;">695</span>918     51           3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> AA        R01AA004610    5<span style="text-decoration: underline;">035</span>947     32           6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> AA        R01AA004961     <span style="text-decoration: underline;">477</span>993     68           1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 87,206 more rows</span></span></span>
<span></span>
<span><span class="va">dollar_bin_grant_costs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">dollar.tile</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 37 × 2</span></span></span>
<span><span class="co">#&gt;    dollar.tile count</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           1 <span style="text-decoration: underline;">23</span>414</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           2 <span style="text-decoration: underline;">35</span>040</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           3 <span style="text-decoration: underline;">12</span>911</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           4  <span style="text-decoration: underline;">6</span>583</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           5  <span style="text-decoration: underline;">2</span>865</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           6  <span style="text-decoration: underline;">1</span>198</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           7   527</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           8   243</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           9   123</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>          10    95</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 27 more rows</span></span></span></code></pre></div>
<p>That looks better. Now we can make the summary plots …</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">dollar_bin_grant_costs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># need to remove higher tiles because there are too few grants</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dollar.tile</span> <span class="op">&lt;=</span> <span class="fl">13</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dollar.tile</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">n.pubs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>outlier.shape <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">breaks</span> <span class="op">/</span> <span class="fl">1e6</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle<span class="op">=</span><span class="fl">45</span>, vjust<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">institute</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">'Number of publications'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Total costs (minimum, in millions)'</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="nihexporter_files/figure-html/plot.dollar.bins-1.png" alt="Productivity versus grant costs for each institute." width="672"><p class="caption">
Productivity versus grant costs for each institute.
</p>
</div>
</div>
<div class="section level3">
<h3 id="comparison-of-grant-programs">Comparison of grant programs<a class="anchor" aria-label="anchor" href="#comparison-of-grant-programs"></a>
</h3>
<p>The NIH provides funds through differet <a href="http://grants.nih.gov/grants/funding/funding_program.htm" class="external-link">grant
programs</a>:</p>
<ul>
<li><p><code>research</code>: investigator-intitiated, actvities begin
with <code>R</code> (e.g., R01)</p></li>
<li><p><code>program</code>: activities begin with <code>P</code>
(e.g. P01)</p></li>
<li><p><code>cooperative agreements</code>: actvities begin with
<code>U</code> (e.g. U54)</p></li>
</ul>
<p>We can examine the total costs spent on specific grants and specific
institutes over time.</p>
<div class="figure">
<img src="nihexporter_files/figure-html/institute_funds-1.png" alt="Funds for specific types of grants at the GM, CA and AI institutes" width="672"><p class="caption">
Funds for specific types of grants at the GM, CA and AI institutes
</p>
</div>
<p>Or we can see how institutes allocate money generally to different
types of grants.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># from http://grants.nih.gov/grants/funding/funding_program.htm</span></span>
<span><span class="va">research_projects</span> <span class="op">&lt;-</span> <span class="va">projects</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'^R'</span>, <span class="va">activity</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">project.num</span><span class="op">)</span></span>
<span><span class="va">program_projects</span> <span class="op">&lt;-</span> <span class="va">projects</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'^P'</span>, <span class="va">activity</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">project.num</span><span class="op">)</span></span>
<span><span class="va">coop_projects</span> <span class="op">&lt;-</span> <span class="va">projects</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">'^U'</span>, <span class="va">activity</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">project.num</span><span class="op">)</span></span>
<span></span>
<span><span class="va">select_inst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'AI'</span>,<span class="st">'CA'</span>,<span class="st">'GM'</span>,<span class="st">'HG'</span>,<span class="st">'AA'</span>,<span class="st">'MH'</span><span class="op">)</span></span>
<span>                </span>
<span><span class="va">grant_costs</span> <span class="op">&lt;-</span> <span class="va">projects</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">institute</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">nih.institutes</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">project.num</span>, <span class="va">institute</span>, <span class="va">fiscal.year</span>, <span class="va">fy.cost</span><span class="op">)</span></span>
<span></span>
<span><span class="va">research_costs</span> <span class="op">&lt;-</span> <span class="va">grant_costs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">semi_join</a></span><span class="op">(</span><span class="va">research_projects</span>, by <span class="op">=</span> <span class="st">'project.num'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">project.num</span>, <span class="va">institute</span>, <span class="va">fiscal.year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>project.cost <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">fy.cost</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">'research'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">program_costs</span> <span class="op">&lt;-</span> <span class="va">grant_costs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">semi_join</a></span><span class="op">(</span><span class="va">program_projects</span>, by <span class="op">=</span> <span class="st">'project.num'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">project.num</span>, <span class="va">institute</span>, <span class="va">fiscal.year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>project.cost <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">fy.cost</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">'program'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">coop_costs</span> <span class="op">&lt;-</span> <span class="va">grant_costs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">semi_join</a></span><span class="op">(</span><span class="va">coop_projects</span>, by <span class="op">=</span> <span class="st">'project.num'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">project.num</span>, <span class="va">institute</span>, <span class="va">fiscal.year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>project.cost <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">fy.cost</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">'cooperative agreements'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">combined_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">research_costs</span>, <span class="va">program_costs</span>, <span class="va">coop_costs</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">combined_tbl</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">fiscal.year</span><span class="op">)</span>,</span>
<span>                         y <span class="op">=</span> <span class="va">project.cost</span>,</span>
<span>                         fill <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>outlier.shape <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e4</span>,<span class="fl">1e7</span><span class="op">)</span>,</span>
<span>                labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/trans_format.html" class="external-link">trans_format</a></span><span class="op">(</span><span class="st">"log10"</span>, <span class="fu"><a href="https://scales.r-lib.org/reference/parse_format.html" class="external-link">math_format</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">institute</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'bottom'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">''</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">'Total grant costs, log-scaled'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="nihexporter_files/figure-html/activity_comparisons-1.png" alt="Comparison of research, program and coop costs over time" width="672"><p class="caption">
Comparison of research, program and coop costs over time
</p>
</div>
</div>
<div class="section level3">
<h3 id="duration">Duration<a class="anchor" aria-label="anchor" href="#duration"></a>
</h3>
<p>The <code>nihexporter</code> exposes <code>project.start</code> and
<code>project.end</code>, which we can use to examine the duration of
projects. For example, we can identify the longest running R01
grants.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">long.grants</span> <span class="op">&lt;-</span> <span class="va">projects</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">activity</span> <span class="op">==</span> <span class="st">'R01'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">project.num</span>, <span class="va">project.start</span>, <span class="va">project.end</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">project.num</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>longest.run <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">project.end</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">project.start</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">longest.run</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>in.years <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">longest.run</span><span class="op">)</span> <span class="op">/</span> <span class="fl">365</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">project.num</span>, <span class="va">in.years</span><span class="op">)</span></span>
<span></span>
<span><span class="va">long.grants</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>               caption <span class="op">=</span> <span class="st">'Longest running R01 grants (all-time)'</span>,</span>
<span>               col.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Project ID'</span>, <span class="st">'Duration (years)'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Longest running R01 grants (all-time)</caption>
<thead><tr class="header">
<th align="left">Project ID</th>
<th align="right">Duration (years)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">R01HL009610</td>
<td align="right">51.03</td>
</tr>
<tr class="even">
<td align="left">R01HL013629</td>
<td align="right">47.03</td>
</tr>
<tr class="odd">
<td align="left">R01HD008188</td>
<td align="right">44.61</td>
</tr>
<tr class="even">
<td align="left">R01DC005259</td>
<td align="right">43.44</td>
</tr>
<tr class="odd">
<td align="left">R01CA020525</td>
<td align="right">43.27</td>
</tr>
<tr class="even">
<td align="left">R01GM013306</td>
<td align="right">43.03</td>
</tr>
<tr class="odd">
<td align="left">R01HL016037</td>
<td align="right">42.94</td>
</tr>
<tr class="even">
<td align="left">R01CA013202</td>
<td align="right">42.86</td>
</tr>
<tr class="odd">
<td align="left">R01CA019033</td>
<td align="right">42.78</td>
</tr>
<tr class="even">
<td align="left">R01DK013499</td>
<td align="right">42.36</td>
</tr>
</tbody>
</table>
<div class="section level4">
<h4 id="geographical-distribution">Geographical distribution<a class="anchor" aria-label="anchor" href="#geographical-distribution"></a>
</h4>
<p>Geographical distribution of grant dollar is easily visualized using
the package.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">state.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>org.state <span class="op">=</span> <span class="va">state.abb</span>,</span>
<span>                         state.name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">state.name</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">state_funding</span> <span class="op">&lt;-</span> <span class="va">projects</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">application.id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">project_orgs</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">org_info</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">projects</span>, by <span class="op">=</span> <span class="st">'application.id'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">application.id</span>, <span class="va">org.state</span>, <span class="va">fy.cost</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">org.state</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>total.fy.cost <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">fy.cost</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1e9</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cost.by.state</span> <span class="op">&lt;-</span> <span class="va">state_funding</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">state.data</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">state.name</span>, <span class="va">total.fy.cost</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">state.name</span> <span class="op">!=</span> <span class="st">"NA"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>region<span class="op">=</span><span class="va">state.name</span>, cost <span class="op">=</span> <span class="va">total.fy.cost</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">region</span>, <span class="va">cost</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">state.map.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/map_data.html" class="external-link">map_data</a></span><span class="op">(</span><span class="st">"state"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">state.map.data</span>, <span class="va">cost.by.state</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html" class="external-link">geom_polygon</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">plot_data</span>, </span>
<span>                      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">long</span>, y<span class="op">=</span><span class="va">lat</span>, group <span class="op">=</span> <span class="va">group</span>, fill<span class="op">=</span><span class="va">plot_data</span><span class="op">$</span><span class="va">cost</span><span class="op">)</span>,</span>
<span>                      colour<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="external-link">scale_fill_continuous</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"lightgrey"</span>, high <span class="op">=</span> <span class="st">"red"</span>, guide<span class="op">=</span><span class="st">"colorbar"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Total Cost per year \n (Billions of dollars)"</span>,x<span class="op">=</span><span class="st">""</span>, y<span class="op">=</span><span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>       <span class="co">#title = "Total cost per fiscal year by state" </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.border <span class="op">=</span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1.4</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>An R package developed by the <a href="https://medschool.cuanschutz.edu/rbi" class="external-link">RNA Bioscience Initiative</a></p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
